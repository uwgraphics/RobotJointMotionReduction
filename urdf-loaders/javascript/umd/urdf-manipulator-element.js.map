{"version":3,"file":"urdf-manipulator-element.js","sources":["../src/URDFDragControls.js","../src/urdf-manipulator-element.js"],"sourcesContent":["import { Raycaster, Vector3, Plane, Vector2 } from 'three';\r\n\r\n// Find the nearest parent that is a joint\r\nfunction isJoint(j) {\r\n\r\n    return j.isURDFJoint && j.jointType !== 'fixed';\r\n\r\n};\r\n\r\nfunction findNearestJoint(child) {\r\n\r\n    let curr = child;\r\n    while (curr) {\r\n\r\n        if (isJoint(curr)) {\r\n\r\n            return curr;\r\n\r\n        }\r\n\r\n        curr = curr.parent;\r\n\r\n    }\r\n\r\n    return curr;\r\n\r\n};\r\n\r\nconst prevHitPoint = new Vector3();\r\nconst newHitPoint = new Vector3();\r\nconst pivotPoint = new Vector3();\r\nconst tempVector = new Vector3();\r\nconst tempVector2 = new Vector3();\r\nconst projectedStartPoint = new Vector3();\r\nconst projectedEndPoint = new Vector3();\r\nconst plane = new Plane();\r\nexport class URDFDragControls {\r\n\r\n    constructor(scene) {\r\n\r\n        this.enabled = true;\r\n        this.scene = scene;\r\n        this.raycaster = new Raycaster();\r\n        this.initialGrabPoint = new Vector3();\r\n\r\n        this.hitDistance = -1;\r\n        this.hovered = null;\r\n        this.manipulating = null;\r\n\r\n    }\r\n\r\n    update() {\r\n\r\n        const {\r\n            raycaster,\r\n            hovered,\r\n            manipulating,\r\n            scene,\r\n        } = this;\r\n\r\n        if (manipulating) {\r\n\r\n            return;\r\n\r\n        }\r\n\r\n        let hoveredJoint = null;\r\n        const intersections = raycaster.intersectObject(scene, true);\r\n        if (intersections.length !== 0) {\r\n\r\n            const hit = intersections[0];\r\n            this.hitDistance = hit.distance;\r\n            hoveredJoint = findNearestJoint(hit.object);\r\n            this.initialGrabPoint.copy(hit.point);\r\n\r\n        }\r\n\r\n        if (hoveredJoint !== hovered) {\r\n\r\n            if (hovered) {\r\n\r\n                this.onUnhover(hovered);\r\n\r\n            }\r\n\r\n            this.hovered = hoveredJoint;\r\n\r\n            if (hoveredJoint) {\r\n\r\n                this.onHover(hoveredJoint);\r\n\r\n            }\r\n\r\n        }\r\n\r\n    }\r\n\r\n    updateJoint(joint, angle) {\r\n\r\n        joint.setJointValue(angle);\r\n\r\n    }\r\n\r\n    onDragStart(joint) {\r\n\r\n    }\r\n\r\n    onDragEnd(joint) {\r\n\r\n    }\r\n\r\n    onHover(joint) {\r\n\r\n    }\r\n\r\n    onUnhover(joint) {\r\n\r\n    }\r\n\r\n    getRevoluteDelta(joint, startPoint, endPoint) {\r\n\r\n        // set up the plane\r\n        tempVector\r\n            .copy(joint.axis)\r\n            .transformDirection(joint.matrixWorld)\r\n            .normalize();\r\n        pivotPoint\r\n            .set(0, 0, 0)\r\n            .applyMatrix4(joint.matrixWorld);\r\n        plane\r\n            .setFromNormalAndCoplanarPoint(tempVector, pivotPoint);\r\n\r\n        // project the drag points onto the plane\r\n        plane.projectPoint(startPoint, projectedStartPoint);\r\n        plane.projectPoint(endPoint, projectedEndPoint);\r\n\r\n        // get the directions relative to the pivot\r\n        projectedStartPoint.sub(pivotPoint);\r\n        projectedEndPoint.sub(pivotPoint);\r\n\r\n        tempVector.crossVectors(projectedStartPoint, projectedEndPoint);\r\n\r\n        const direction = Math.sign(tempVector.dot(plane.normal));\r\n        return direction * projectedEndPoint.angleTo(projectedStartPoint);\r\n\r\n    }\r\n\r\n    getPrismaticDelta(joint, startPoint, endPoint) {\r\n\r\n        tempVector.subVectors(endPoint, startPoint);\r\n        plane\r\n            .normal\r\n            .copy(joint.axis)\r\n            .transformDirection(joint.parent.matrixWorld)\r\n            .normalize();\r\n\r\n        return tempVector.dot(plane.normal);\r\n\r\n    }\r\n\r\n    moveRay(toRay) {\r\n\r\n        const { raycaster, hitDistance, manipulating } = this;\r\n        const { ray } = raycaster;\r\n\r\n        if (manipulating) {\r\n\r\n            ray.at(hitDistance, prevHitPoint);\r\n            toRay.at(hitDistance, newHitPoint);\r\n\r\n            let delta = 0;\r\n            if (manipulating.jointType === 'revolute' || manipulating.jointType === 'continuous') {\r\n\r\n                delta = this.getRevoluteDelta(manipulating, prevHitPoint, newHitPoint);\r\n\r\n            } else if (manipulating.jointType === 'prismatic') {\r\n\r\n                delta = this.getPrismaticDelta(manipulating, prevHitPoint, newHitPoint);\r\n\r\n            }\r\n\r\n            if (delta) {\r\n\r\n                this.updateJoint(manipulating, manipulating.angle + delta);\r\n\r\n            }\r\n\r\n        }\r\n\r\n        this.raycaster.ray.copy(toRay);\r\n        this.update();\r\n\r\n    }\r\n\r\n    setGrabbed(grabbed) {\r\n\r\n        const { hovered, manipulating } = this;\r\n\r\n        if (grabbed) {\r\n\r\n            if (manipulating !== null || hovered === null) {\r\n\r\n                return;\r\n\r\n            }\r\n\r\n            this.manipulating = hovered;\r\n            this.onDragStart(hovered);\r\n\r\n        } else {\r\n\r\n            if (this.manipulating === null) {\r\n                return;\r\n            }\r\n\r\n            this.onDragEnd(this.manipulating);\r\n            this.manipulating = null;\r\n            this.update();\r\n\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\nexport class PointerURDFDragControls extends URDFDragControls {\r\n\r\n    constructor(scene, camera, domElement) {\r\n\r\n        super(scene);\r\n        this.camera = camera;\r\n        this.domElement = domElement;\r\n\r\n        const raycaster = new Raycaster();\r\n        const mouse = new Vector2();\r\n\r\n        function updateMouse(e) {\r\n\r\n            mouse.x = ((e.pageX - domElement.offsetLeft) / domElement.offsetWidth) * 2 - 1;\r\n            mouse.y = -((e.pageY - domElement.offsetTop) / domElement.offsetHeight) * 2 + 1;\r\n\r\n        }\r\n\r\n        this._mouseDown = e => {\r\n\r\n            updateMouse(e);\r\n            raycaster.setFromCamera(mouse, this.camera);\r\n            this.moveRay(raycaster.ray);\r\n            this.setGrabbed(true);\r\n\r\n        };\r\n\r\n        this._mouseMove = e => {\r\n\r\n            updateMouse(e);\r\n            raycaster.setFromCamera(mouse, this.camera);\r\n            this.moveRay(raycaster.ray);\r\n\r\n        };\r\n\r\n        this._mouseUp = e => {\r\n\r\n            updateMouse(e);\r\n            raycaster.setFromCamera(mouse, this.camera);\r\n            this.moveRay(raycaster.ray);\r\n            this.setGrabbed(false);\r\n\r\n        };\r\n\r\n        domElement.addEventListener('mousedown', this._mouseDown);\r\n        domElement.addEventListener('mousemove', this._mouseMove);\r\n        domElement.addEventListener('mouseup', this._mouseUp);\r\n\r\n    }\r\n\r\n    getRevoluteDelta(joint, startPoint, endPoint) {\r\n\r\n        const { camera, initialGrabPoint } = this;\r\n\r\n        // set up the plane\r\n        tempVector\r\n            .copy(joint.axis)\r\n            .transformDirection(joint.matrixWorld)\r\n            .normalize();\r\n        pivotPoint\r\n            .set(0, 0, 0)\r\n            .applyMatrix4(joint.matrixWorld);\r\n        plane\r\n            .setFromNormalAndCoplanarPoint(tempVector, pivotPoint);\r\n\r\n        tempVector\r\n            .copy(camera.position)\r\n            .sub(initialGrabPoint)\r\n            .normalize();\r\n\r\n        // if looking into the plane of rotation\r\n        if (Math.abs(tempVector.dot(plane.normal)) > 0.3) {\r\n\r\n            return super.getRevoluteDelta(joint, startPoint, endPoint);\r\n\r\n        } else {\r\n\r\n            // get the up direction\r\n            tempVector.set(0, 1, 0).transformDirection(camera.matrixWorld);\r\n\r\n            // get points projected onto the plane of rotation\r\n            plane.projectPoint(startPoint, projectedStartPoint);\r\n            plane.projectPoint(endPoint, projectedEndPoint);\r\n\r\n            tempVector.set(0, 0, -1).transformDirection(camera.matrixWorld);\r\n            tempVector.cross(plane.normal);\r\n            tempVector2.subVectors(endPoint, startPoint);\r\n\r\n            return tempVector.dot(tempVector2);\r\n\r\n        }\r\n\r\n    }\r\n\r\n    dispose() {\r\n\r\n        const { domElement } = this;\r\n        domElement.removeEventListener('mousedown', this._mouseDown);\r\n        domElement.removeEventListener('mousemove', this._mouseMove);\r\n        domElement.removeEventListener('mouseup', this._mouseUp);\r\n\r\n    }\r\n\r\n}\r\n","import * as THREE from 'three';\r\nimport URDFViewer from './urdf-viewer-element.js';\r\nimport { PointerURDFDragControls } from './URDFDragControls.js';\r\n\r\n// urdf-manipulator element\r\n// Displays a URDF model that can be manipulated with the mouse\r\n\r\n// Events\r\n// joint-mouseover: Fired when a joint is hovered over\r\n// joint-mouseout: Fired when a joint is no longer hovered over\r\n// manipulate-start: Fires when a joint is manipulated\r\n// manipulate-end: Fires when a joint is done being manipulated\r\nexport default\r\nclass URDFManipulator extends URDFViewer {\r\n\r\n    static get observedAttributes() {\r\n\r\n        return ['highlight-color', ...super.observedAttributes];\r\n\r\n    }\r\n\r\n    get disableDragging() { return this.hasAttribute('disable-dragging'); }\r\n    set disableDragging(val) { val ? this.setAttribute('disable-dragging', !!val) : this.removeAttribute('disable-dragging'); }\r\n\r\n    get highlightColor() { return this.getAttribute('highlight-color') || '#FFFFFF'; }\r\n    set highlightColor(val) { val ? this.setAttribute('highlight-color', val) : this.removeAttribute('highlight-color'); }\r\n\r\n    constructor(...args) {\r\n\r\n        super(...args);\r\n\r\n        // The highlight material\r\n        this.highlightMaterial =\r\n            new THREE.MeshPhongMaterial({\r\n                shininess: 10,\r\n                color: this.highlightColor,\r\n                emissive: this.highlightColor,\r\n                emissiveIntensity: 0.25,\r\n            });\r\n\r\n        const isJoint = j => {\r\n\r\n            return j.isURDFJoint && j.jointType !== 'fixed';\r\n\r\n        };\r\n\r\n        // Highlight the link geometry under a joint\r\n        const highlightLinkGeometry = (m, revert) => {\r\n\r\n            const traverse = c => {\r\n\r\n                // Set or revert the highlight color\r\n                if (c.type === 'Mesh') {\r\n\r\n                    if (revert) {\r\n\r\n                        c.material = c.__origMaterial;\r\n                        delete c.__origMaterial;\r\n\r\n                    } else {\r\n\r\n                        c.__origMaterial = c.material;\r\n                        c.material = this.highlightMaterial;\r\n\r\n                    }\r\n\r\n                }\r\n\r\n                // Look into the children and stop if the next child is\r\n                // another joint\r\n                if (c === m || !isJoint(c)) {\r\n\r\n                    for (let i = 0; i < c.children.length; i++) {\r\n\r\n                        traverse(c.children[i]);\r\n\r\n                    }\r\n\r\n                }\r\n\r\n            };\r\n\r\n            traverse(m);\r\n\r\n        };\r\n\r\n        const el = this.renderer.domElement;\r\n\r\n        const dragControls = new PointerURDFDragControls(this.scene, this.camera, el);\r\n        dragControls.onDragStart = joint => {\r\n\r\n            this.dispatchEvent(new CustomEvent('manipulate-start', { bubbles: true, cancelable: true, detail: joint.name }));\r\n            this.controls.enabled = false;\r\n            this.redraw();\r\n\r\n        };\r\n        dragControls.onDragEnd = joint => {\r\n\r\n            this.dispatchEvent(new CustomEvent('manipulate-end', { bubbles: true, cancelable: true, detail: joint.name }));\r\n            this.controls.enabled = true;\r\n            this.redraw();\r\n\r\n        };\r\n        dragControls.updateJoint = (joint, angle) => {\r\n\r\n            this.setJointValue(joint.name, angle);\r\n\r\n        };\r\n        dragControls.onHover = joint => {\r\n\r\n            highlightLinkGeometry(joint, false);\r\n            this.dispatchEvent(new CustomEvent('joint-mouseover', { bubbles: true, cancelable: true, detail: joint.name }));\r\n            this.redraw();\r\n\r\n        };\r\n        dragControls.onUnhover = joint => {\r\n\r\n            highlightLinkGeometry(joint, true);\r\n            this.dispatchEvent(new CustomEvent('joint-mouseout', { bubbles: true, cancelable: true, detail: joint.name }));\r\n            this.redraw();\r\n\r\n        };\r\n\r\n        this.dragControls = dragControls;\r\n\r\n    }\r\n\r\n    disconnectedCallback() {\r\n\r\n        super.disconnectedCallback();\r\n        this.dragControls.dispose();\r\n\r\n    }\r\n\r\n    attributeChangedCallback(attr, oldval, newval) {\r\n\r\n        super.attributeChangedCallback(attr, oldval, newval);\r\n\r\n        switch (attr) {\r\n\r\n            case 'highlight-color':\r\n                this.highlightMaterial.color.set(this.highlightColor);\r\n                this.highlightMaterial.emissive.set(this.highlightColor);\r\n                break;\r\n\r\n        }\r\n\r\n    }\r\n\r\n};\r\n"],"names":["Vector3","Plane","Raycaster","Vector2","URDFViewer","THREE.MeshPhongMaterial"],"mappings":"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"}